---
title: "homicide_rate"
format: 
  html:
    include-in-header:
      - text: |
          <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
---

```{r echo=FALSE}
data <- read.csv("data/API_VC.IHR.PSRC.P5_DS2_en_csv_v2_57.csv", header = FALSE, comment.char = "#")
date_updated <- as.Date(data[2, 2])
data <- data[-c(1:2),]
names(data) <- unlist(c(data[1, ]))
data <- data[-1,]
names(data) <- tolower(sub("[[:space:]]", "_", names(data)))

data <- data[data$country_name %in% c("France", "Germany", "Italy", "Spain", "Switzerland", "United Kingdom"), ]
data <- data[order(data$country_name),]
data <- data[, !names(data) %in% as.character(1950:1991)]
for (col_nb in ncol(data):1) {
  if (sum(is.na(data[[col_nb]])) == nrow(data)) {
    data[, col_nb] <- NULL
  }
}
# data_json <- jsonlite::toJSON(data, dataframe = "columns")
ojs_define(data = data)
```

```{ojs}
//| echo: false

yearlyChart = Plot.plot({
  marks: [
    Plot.line(transpose(data), 
      {x: "1995", y: "1996"}, 
      { stroke: "black" }
    )
  ]}
)
```

```{ojs}

data2 = [{
  x: [1, 2, 3, 4, 5],
  y: [2, 3, 5, 4, 7],
  mode: 'markers',
  type: 'scatter'
}];

layout = {
  title: 'Simple Scatter Plot'
};

plot = {
  let div = DOM.element('div');
  Plotly.newPlot(div, data2, layout);
  return div;
}

```

```{ojs}
plot2 = {
  const trace = {
    x: data['1995'],
    y: data['1996'],
    mode: 'markers',
    type: 'scatter'
  };

  const layout = {
    title: 'Scatterplot',
    xaxis: {title: 'X Axis'},
    yaxis: {title: 'Y Axis'}
  };

  let div = DOM.element('div');
  Plotly.newPlot(div, [trace], layout);
  return div;
}
```
